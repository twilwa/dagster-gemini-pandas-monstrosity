"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[63],{46928:function(e,n,t){t.d(n,{Q1:function(){return j},Qf:function(){return useSelectedRunsTab},zc:function(){return useRunListTabs}});var r=t(85333),u=t(6692),o=t(58467),i=t(73235),s=t(82550),a=t(52322),l=t(40794),c=t(60138),d=t(9001),f=t(25195),p=t(18149),h=t.n(p),m=t(2784),v=t(7267),b=t(35505),R=t(6315),_=t(49313),g=t(28252),x=t(16148);function _templateObject(){var e=(0,i._)(["\n          background-color: ",";\n          color: ",";\n\n          &&:hover {\n            background-color: ",";\n            color: ",";\n          }\n        "]);return _templateObject=function(){return e},e}function _templateObject1(){var e=(0,i._)(["\n          background-color: ",";\n        "]);return _templateObject1=function(){return e},e}function _templateObject2(){var e=(0,i._)(["\n  color: ",";\n\n  &&:hover {\n    color: ",";\n  }\n\n  ","\n"]);return _templateObject2=function(){return e},e}function _templateObject3(){var e=(0,i._)(["\n  query RunTabsCountQuery($queuedFilter: RunsFilter!, $inProgressFilter: RunsFilter!) {\n    queuedCount: pipelineRunsOrError(filter: $queuedFilter) {\n      ... on Runs {\n        count\n      }\n    }\n    inProgressCount: pipelineRunsOrError(filter: $inProgressFilter) {\n      ... on Runs {\n        count\n      }\n    }\n  }\n"]);return _templateObject3=function(){return e},e}var getDocumentTitle=function(e){switch(e){case"all":return"Runs | All runs";case"failed":return"Runs | Failed";case"in-progress":return"Runs | In progress";case"queued":return"Runs | Queued";case"scheduled":return"Runs | Scheduled";default:return"Runs"}},useRunListTabs=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,l.a)(y,{variables:{queuedFilter:(0,u._)((0,r._)({},e),{statuses:Array.from(R.sy)}),inProgressFilter:(0,u._)((0,r._)({},e),{statuses:Array.from(R.Ys)})}}),t=n.data,i=(0,m.useMemo)(function(){var e,n;return{queuedCount:(null==t?void 0:null===(e=t.queuedCount)||void 0===e?void 0:e.__typename)==="Runs"?t.queuedCount.count:null,inProgressCount:(null==t?void 0:null===(n=t.inProgressCount)||void 0===n?void 0:n.__typename)==="Runs"?t.inProgressCount.count:null}},[t]),c=i.queuedCount,f=i.inProgressCount,p=(0,o._)((0,_.oD)(),1)[0],h=useSelectedRunsTab(p);(0,g.j)(getDocumentTitle(h));var urlForStatus=function(e){var n=p.filter(function(e){return"status"!==e.token}),t=e.map(function(e){return{token:"status",value:e}});return(0,_.it)((0,s._)(t).concat((0,s._)(n)))};return{tabs:(0,a.jsxs)(d.zH,{children:[(0,a.jsx)(j,{to:urlForStatus([]),id:"all",$active:"all"===h,children:"All runs"}),(0,a.jsxs)(j,{to:urlForStatus(Array.from(R.sy)),id:"queued",$active:"queued"===h,children:["Queued (",null!=c?c:"indeterminate",")"]}),(0,a.jsxs)(j,{to:urlForStatus(Array.from(R.Ys)),id:"in-progress",$active:"in-progress"===h,children:["In progress (",null!=f?f:"indeterminate",")"]}),(0,a.jsx)(j,{to:urlForStatus(Array.from(R.hd)),id:"failed",$active:"failed"===h,children:"Failed"}),(0,a.jsx)(j,{title:"Scheduled",to:"/runs/scheduled",id:"scheduled",$active:"scheduled"===h,children:"Scheduled"})]}),queryResult:n}},j=(0,b.ZP)(x.A).withConfig({componentId:"sc-9136b65b-0"})(_templateObject2(),f.$(),f.$(),function(e){return e.$active?(0,b.iv)(_templateObject(),f.AU(),f.Ep(),f.AU(),f.Ep()):(0,b.iv)(_templateObject1(),f.v8())}),useSelectedRunsTab=function(e){var n=(0,v.TH)().pathname;if("/runs/timeline"===n)return"timeline";if("/runs/scheduled"===n)return"scheduled";if("/overview/backfills"===n)return"backfills";var t=new Set(e.filter(function(e){return"status"===e.token}).map(function(e){return e.value}));return h()(R.sy,t)?"queued":h()(R.Ys,t)?"in-progress":h()(R.hd,t)?"failed":"all"},y=(0,c.Ps)(_templateObject3())},5063:function(e,n,t){t.r(n),t.d(n,{RUNS_ROOT_QUERY:function(){return W},RunsRoot:function(){return RunsRoot},default:function(){return Z}});var r=t(85333),u=t(6692),o=t(58467),i=t(73235),s=t(82550),a=t(52322),l=t(60138),c=t(22139),d=t(21221),f=t(28888),p=t(17131),h=t(81308),m=t(92364),v=t(12084),b=t(83302),R=t(96795),_=t.n(R),g=t(2784),x=t(40794),j=t(9676),y=t(47933),C=t(74897),w=t(78945);function _templateObject(){var e=(0,i._)(['\n  query QueueDaemonStatusQuery {\n    instance {\n      id\n      daemonHealth {\n        id\n        daemonStatus(daemonType: "QUEUED_RUN_COORDINATOR") {\n          id\n          daemonType\n          healthy\n          required\n        }\n      }\n    }\n  }\n']);return _templateObject=function(){return e},e}var QueuedRunsBanners=function(){var e=(0,w._)();return(0,a.jsxs)(c.x,{flex:{direction:"column",gap:8},style:{minWidth:"100%"},border:"bottom",children:[e&&(0,a.jsx)(j.b,{intent:"info",title:(0,a.jsx)(y.rU,{to:"/config#run_coordinator",children:"View queue configuration"})}),e&&(0,a.jsx)(QueueDaemonAlert,{})]})},QueueDaemonAlert=function(){var e=(0,x.a)(O).data,n=(0,g.useContext)(C.N).pageTitle,t=null==e?void 0:e.instance.daemonHealth.daemonStatus;return(null==t?void 0:t.required)&&!(null==t?void 0:t.healthy)?(0,a.jsx)(j.b,{intent:"warning",title:"The queued run coordinator is not healthy.",description:(0,a.jsxs)("div",{children:["View ",(0,a.jsx)(y.rU,{to:"/health",children:n})," for details."]})}):null},O=(0,l.Ps)(_templateObject()),k=t(46928),q=t(6315),T=t(64107),E=t(38917),A=t(49313),P=t(81862),F=t(22970),S=t(56675),$=t(9001),Q=t(18149),B=t.n(Q),N=t(16322);function TerminateAllRunsButton_templateObject(){var e=(0,i._)(["\n  query TerminateRunIdsQuery($filter: RunsFilter!) {\n    pipelineRunsOrError(filter: $filter) {\n      ... on Runs {\n        results {\n          id\n          status\n          canTerminate\n        }\n      }\n    }\n  }\n"]);return TerminateAllRunsButton_templateObject=function(){return e},e}var TerminateAllRunsButton=function(e){var n,t=e.refetch,r=e.filter,u=e.disabled,i=(0,o._)((0,g.useState)(null),2),s=i[0],l=i[1],c=(0,S.x)(),d=(n=(0,P._)(function(){var e;return(0,F.Jh)(this,function(n){switch(n.label){case 0:return[4,c.query({query:D,variables:{filter:r}})];case 1:return l("Runs"===(e=n.sent()).data.pipelineRunsOrError.__typename?Object.fromEntries(e.data.pipelineRunsOrError.results.map(function(e){return[e.id,e.canTerminate]})):{}),[2]}})}),function(){return n.apply(this,arguments)});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(N.A,{isOpen:null!==s,selectedRuns:s||{},selectedRunsAllQueued:B()(r,{statuses:Array.from(q.sy)}),onClose:function(){return l(null)},onComplete:function(){return t()}}),(0,a.jsx)($.zx,{intent:"danger",outlined:!0,disabled:u,onClick:d,children:"Terminate allâ€¦"})]})},D=(0,l.Ps)(TerminateAllRunsButton_templateObject()),I=t(65767),U=t(91195),z=t(55237),H=t(68028),Y=t(28316);function DOMNodeHost(e){var n=e.node,t=g.useRef(null);return g.useLayoutEffect(function(){var e=t.current;if(n.parentNode!==e){if(null!==n.parentNode&&n.parentNode!==e)throw Error("Cannot render the same node twice");return null==e||e.appendChild(n),function(){null==e||e.removeChild(n)}}},[n]),(0,a.jsx)("div",{ref:t})}var L=t(83568),M=t(90894),V=t(19358);function RunsRoot_templateObject(){var e=(0,i._)(["\n  query RunsRootQuery($limit: Int, $cursor: String, $filter: RunsFilter!) {\n    pipelineRunsOrError(limit: $limit, cursor: $cursor, filter: $filter) {\n      ... on Runs {\n        results {\n          id\n          ...RunTableRunFragment\n        }\n      }\n      ... on InvalidPipelineRunsFilterError {\n        message\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n  ","\n"]);return RunsRoot_templateObject=function(){return e},e}var RunsRoot=function(){var e,n,t,actionBar=function(){var e,n,t,o;return(0,a.jsxs)(c.x,{style:{width:"100%",marginRight:8},flex:{justifyContent:"space-between"},children:[(0,a.jsxs)(c.x,{flex:{direction:"row",alignItems:"center",gap:8},children:[J,eo]}),"queued"===P?(0,a.jsx)(TerminateAllRunsButton,{refetch:G.refetch,filter:(0,u._)((0,r._)({},j),{statuses:Array.from(q.sy)}),disabled:(null===(e=K.data)||void 0===e?void 0:e.queuedCount.__typename)!=="Runs"||(null===(n=K.data)||void 0===n?void 0:n.queuedCount.count)===0}):"in-progress"===P?(0,a.jsx)(TerminateAllRunsButton,{refetch:G.refetch,filter:(0,u._)((0,r._)({},j),{statuses:Array.from(q.Ys)}),disabled:(null===(t=K.data)||void 0===t?void 0:t.inProgressCount.__typename)!=="Runs"||(null===(o=K.data)||void 0===o?void 0:o.inProgressCount.count)===0}):void 0]})};(0,H.Px)();var i=(0,L.se)("RunsRoot"),l=(0,o._)((0,A.oD)(),2),R=l[0],x=l[1],j=(0,A.VH)(R),y=(0,I.l)({nextCursorForResult:function(e){var n;if("Runs"===e.pipelineRunsOrError.__typename)return null===(n=e.pipelineRunsOrError.results[24])||void 0===n?void 0:n.id},getResultArray:function(e){return e&&"Runs"===e.pipelineRunsOrError.__typename?e.pipelineRunsOrError.results:[]},variables:{filter:j},query:W,pageSize:25}),C=y.queryResult,w=y.paginationProps,O=(0,z.C4)(C,z.dT),P=(0,k.Qf)(R),F="all"!==P,S=(0,o._)(_()(R,function(e){return"status"===e.token}),2),$=S[0],Q=S[1],B=(0,g.useCallback)(function(e){F?x((0,s._)($).concat((0,s._)(e))):x(e)},[x,F,$]),N=(0,g.useCallback)(function(e){var n=(0,d.HY)(e);Q.some(function(e){return(0,d.HY)(e)===n})||B((0,s._)(Q).concat([e]))},[Q,B]),D=(0,g.useMemo)(function(){var e=["tag","snapshotId","id","job","pipeline","partition","backfill"];return F||e.push("status"),e},[F]),U=(0,g.useMemo)(function(){return F?R.filter(function(e){return"status"!==e.token}):R},[R,F]),Z=(0,k.zc)(j),J=Z.tabs,K=Z.queryResult,X=(0,z.C4)(K,z.dT),G=(0,z.V5)(X,O),ee=(0,A.Vv)({tokens:U,onChange:B,enabledFilters:D}),en=ee.button,et=ee.activeFiltersJsx,er=(0,o._)((n=(e=(0,o._)(g.useState(null),2))[0],t=e[1],g.useLayoutEffect(function(){t(function(e){return null===e?document.createElement("div"):e})},[]),[n?(0,Y.createPortal)(en,n):null,n?(0,a.jsx)(DOMNodeHost,{node:n}):null]),2),eu=er[0],eo=er[1];return(0,a.jsxs)(f.T,{children:[(0,a.jsx)(p.m,{title:(0,a.jsx)(h.X6,{children:"Runs"}),right:(0,a.jsx)(z.xi,{refreshState:G})}),eu,(0,a.jsx)(E.Lw.Provider,{value:{refetch:C.refetch},children:(0,a.jsx)(M.g,{queryResult:C,allowStaleData:!0,renderError:function(e){var n=!!((null==e?void 0:e.networkError)&&"statusCode"in e.networkError&&400===e.networkError.statusCode);return(0,a.jsxs)(c.x,{flex:{direction:"column",gap:32},padding:{vertical:8,left:24,right:12},children:[actionBar(),(0,a.jsx)(m.t,{icon:"warning",title:n?"Invalid run filters":"Unexpected error",description:n?"The specified run filters are not valid. Please check the filters and try again.":"An unexpected error occurred. Check the console for details."})]})},children:function(e){var n=e.pipelineRunsOrError;return"Runs"!==n.__typename?(0,a.jsx)(c.x,{padding:{vertical:64},children:(0,a.jsx)(m.t,{icon:"error",title:"Query Error",description:n.message})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(RunsRootPerformanceEmitter,{trace:i}),(0,a.jsx)(V.Y,{$top:0,children:(0,a.jsx)(T.AL,{runs:n.results.slice(0,25),onAddTag:N,filter:j,actionBarComponents:actionBar(),belowActionBarComponents:"queued"===P||et.length?(0,a.jsxs)(a.Fragment,{children:["queued"===P&&(0,a.jsx)(QueuedRunsBanners,{}),et.length>0&&(0,a.jsxs)(a.Fragment,{children:[et,(0,a.jsx)(v.Z,{onClick:function(){return B([])},children:"Clear all"})]})]}):null})}),n.results.length>0?(0,a.jsx)("div",{style:{marginTop:"16px"},children:(0,a.jsx)(b.pI,(0,r._)({},w))}):null]})}})})]})},RunsRootPerformanceEmitter=function(e){var n=e.trace;return(0,g.useLayoutEffect)(function(){n.endTrace()},[n]),null},Z=RunsRoot,W=(0,l.Ps)(RunsRoot_templateObject(),T.ZZ,U.B)},65767:function(e,n,t){t.d(n,{l:function(){return useCursorPaginatedQuery}});var r=t(85333),u=t(6692),o=t(58467),i=t(82550),s=t(40794),a=t(2784),l=t(71277);function useCursorPaginatedQuery(e){var n=(0,o._)((0,a.useState)(function(){return[]}),2),t=n[0],c=n[1],d=(0,o._)((0,l.q)({queryKey:"cursor"}),2),f=d[0],p=d[1],h=(0,u._)((0,r._)({},e.variables),{cursor:f,limit:e.pageSize+1}),m=(0,s.a)(e.query,{skip:e.skip,variables:h,notifyOnNetworkStatusChange:!0}),v={hasPrevCursor:!!f,hasNextCursor:e.getResultArray(m.data).length===e.pageSize+1,popCursor:function(){var e=(0,i._)(t);p(e.pop()),c(e)},advanceCursor:function(){f&&c(function(e){return(0,i._)(e).concat([f])});var n=m.data&&e.nextCursorForResult(m.data);n&&p(n)},reset:function(){c([]),p(void 0)}};return{queryResult:m,paginationProps:v}}},19358:function(e,n,t){t.d(n,{Y:function(){return o}});var r=t(73235),u=t(25195);function _templateObject(){var e=(0,r._)(["\n  thead tr {\n    position: sticky;\n    top: ","px;\n    background-color: ",";\n    z-index: 1;\n  }\n\n  /**\n   * Safari won't render a box-shadow on the `tr` and we don't want an inset\n   * box-shadow on `th` elements because it will create a double-border on the\n   * bottom of the `thead` in the non-stuck state.\n   *\n   * We therefore render an absoulutely-positioned keyline on the bottom of the\n   * `th` elements. This will appear as a border in the stuck state, and will\n   * overlap the top box-shadow of the first row in the non-stuck state.\n   */\n  thead tr th {\n    position: relative;\n  }\n\n  thead tr th::after {\n    content: '';\n    display: block;\n    height: 1px;\n    background-color: ",";\n    position: absolute;\n    bottom: -1px;\n    left: 0;\n    right: 0;\n  }\n"],["\n  thead tr {\n    position: sticky;\n    top: ","px;\n    background-color: ",";\n    z-index: 1;\n  }\n\n  /**\n   * Safari won't render a box-shadow on the \\`tr\\` and we don't want an inset\n   * box-shadow on \\`th\\` elements because it will create a double-border on the\n   * bottom of the \\`thead\\` in the non-stuck state.\n   *\n   * We therefore render an absoulutely-positioned keyline on the bottom of the\n   * \\`th\\` elements. This will appear as a border in the stuck state, and will\n   * overlap the top box-shadow of the first row in the non-stuck state.\n   */\n  thead tr th {\n    position: relative;\n  }\n\n  thead tr th::after {\n    content: '';\n    display: block;\n    height: 1px;\n    background-color: ",";\n    position: absolute;\n    bottom: -1px;\n    left: 0;\n    right: 0;\n  }\n"]);return _templateObject=function(){return e},e}var o=t(35505).ZP.div.withConfig({componentId:"sc-1e417a12-0"})(_templateObject(),function(e){var n=e.$top;return void 0===n?0:n},u.v8(),u.wL())}}]);
//# sourceMappingURL=63.3a74761b64dbf781.js.map
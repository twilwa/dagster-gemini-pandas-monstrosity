(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[342],{30733:function(t,e,n){var r=n(96738);function memoize(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw TypeError("Expected a function");var memoized=function(){var n=arguments,r=e?e.apply(this,n):n[0],o=memoized.cache;if(o.has(r))return o.get(r);var i=t.apply(this,n);return memoized.cache=o.set(r,i)||o,i};return memoized.cache=new(memoize.Cache||r),memoized}memoize.Cache=r,t.exports=memoize},50342:function(t,e,n){"use strict";function _array_like_to_array(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function _unsupported_iterable_to_array(t,e){if(t){if("string"==typeof t)return _array_like_to_array(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _array_like_to_array(t,e)}}function _sliced_to_array_sliced_to_array(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n,r,o=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=o){var i=[],a=!0,u=!1;try{for(o=o.call(t);!(a=(n=o.next()).done)&&(i.push(n.value),!e||i.length!==e);a=!0);}catch(t){u=!0,r=t}finally{try{a||null==o.return||o.return()}finally{if(u)throw r}}return i}}(t,e)||_unsupported_iterable_to_array(t,e)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var r,o,i,a,u,d=n(46506);function _to_consumable_array_to_consumable_array(t){return function(t){if(Array.isArray(t))return _array_like_to_array(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||_unsupported_iterable_to_array(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var s=n(41059),c=(n(2784),n(72779)),h=n(13980),l=n.n(h),f=n(60568);l().oneOfType([l().func,l().object]),l().func,l().func,l().func,l().func,l().func,l().string,l().func,l().any;var p=n(30733),y=n.n(p);n(77105);var g=y()(function(){return function(t){var e=void 0;try{if(e=window.localStorage.getItem(t))return JSON.parse(e)}catch(t){if("string"==typeof e)return e;return}}("DAGSTER_FLAGS")||[]});y()(function(t){return g().includes(t)}),y()(function(t){return new Intl.NumberFormat(t,{minimumFractionDigits:3,maximumFractionDigits:3})}),new Intl.Collator(navigator.language,{sensitivity:"base"}),(0,s.H)({source:function(t){return t.source},target:function(t){return t.target},x:function(t){return t.x},y:function(t){return t.y}}),o=(r={source:function(t){return t.source},target:function(t){return t.target},x:function(t){return t.x},y:function(t){return t.y}}).source,i=r.target,a=r.x,u=r.y;var groupIdForNode=function(t){return[t.definition.repository.name,"@",t.definition.repository.location.name,":",t.definition.groupName].join("")},m=y()(function(t,e){var n=Object.keys(e.upstream[JSON.stringify(t.path)]||{}).map(function(t){return{path:JSON.parse(t),__typename:"AssetKey"}});return[t].concat(_to_consumable_array_to_consumable_array(n),_to_consumable_array_to_consumable_array(n.map(function(t){return m(t,e)}).flat())).filter(function(t,e,n){return n.findIndex(function(e){return JSON.stringify(e)===JSON.stringify(t)})===e})},function(t,e){return JSON.stringify({key:t,data:e})}),v={horizontal:{ranker:"tight-tree",direction:"horizontal",marginx:100,marginy:100,ranksep:60,rankdir:"LR",edgesep:90,nodesep:-10,nodeHeight:"auto",groupPaddingTop:65,groupPaddingBottom:-15,groupRendering:"if-varied",clusterpaddingtop:100},vertical:{ranker:"tight-tree",direction:"horizontal",marginx:100,marginy:100,ranksep:20,rankdir:"TB",nodesep:40,edgesep:10,nodeHeight:"auto",groupPaddingTop:40,groupPaddingBottom:-20,groupRendering:"if-varied"}},layoutAssetGraph=function(t,e){var n=new d.graphlib.Graph({compound:!0}),r=Object.assign({},v[e.direction],e.overrides||{});n.setGraph(r),n.setDefaultEdgeLabel(function(){return{}});var shouldRender=function(t){return t},o=Object.values(t.nodes).filter(shouldRender),i=t.expandedGroups||[],a={},u=!0,s=!1,c=void 0;try{for(var h,l=o[Symbol.iterator]();!(u=(h=l.next()).done);u=!0){var f=h.value;if(f.definition.groupName){var p=groupIdForNode(f);a[p]=a[p]||{id:p,expanded:i.includes(p),groupName:f.definition.groupName,repositoryName:f.definition.repository.name,repositoryLocationName:f.definition.repository.location.name,bounds:{x:0,y:0,width:0,height:0}}}}}catch(t){s=!0,c=t}finally{try{u||null==l.return||l.return()}finally{if(s)throw c}}var y="if-varied"!==r.groupRendering||Object.keys(a).length>1;y&&Object.keys(a).forEach(function(t){i.includes(t)?n.setNode(t,{borderType:"borderRight"}):n.setNode(t,{width:x,height:110})}),o.forEach(function(t){if(!y||i.includes(groupIdForNode(t))){var e="auto"===r.nodeHeight?getAssetNodeDimensions(t.definition):{width:x,height:r.nodeHeight};n.setNode(t.id,e),y&&t.definition.groupName&&n.setParent(t.id,groupIdForNode(t))}});var g={},m=Object.fromEntries(Object.entries(t.nodes).map(function(t){var e=_sliced_to_array_sliced_to_array(t,2);return[e[0],groupIdForNode(e[1])]}));Object.entries(t.downstream).forEach(function(e){var r=_sliced_to_array_sliced_to_array(e,2),o=r[0];Object.keys(r[1]).forEach(function(e){if(shouldRender(t.nodes[e])||shouldRender(t.nodes[o])){var r=o,a=e,u=m[e];y&&u&&!i.includes(u)&&(a=u);var d=m[o];y&&d&&!i.includes(d)&&(r=d),r!==a&&(n.setEdge({v:r,w:a},{weight:1}),shouldRender(t.nodes[e])?shouldRender(t.nodes[o])||(g[o]=!0):g[e]=!0)}})}),Object.keys(g).forEach(function(t){var r=JSON.parse(t),o=r[r.length-1]||"";n.setNode(t,getAssetLinkDimensions(o,e))}),d.layout(n);var b=1,_=1,w={};if(n.nodes().forEach(function(t){var e=n.node(t);if((null==e?void 0:e.x)&&(null==e?void 0:e.width)){var r={x:e.x-e.width/2,y:e.y-e.height/2,width:e.width,height:e.height};/^[^@:]+@[^@:]+:.+$/.test(t)?i.includes(t)||(a[t].bounds=r):w[t]={id:t,bounds:r},b=Math.max(b,e.x+e.width/2),_=Math.max(_,e.y+e.height/2)}}),y){var O=!0,E=!1,N=void 0;try{for(var I,k=o[Symbol.iterator]();!(O=(I=k.next()).done);O=!0){var S=I.value,j=w[S.id];if(j&&S.definition.groupName){var M=a[groupIdForNode(S)];M.bounds=0===M.bounds.width?j.bounds:extendBounds(M.bounds,j.bounds)}}}catch(t){E=!0,N=t}finally{try{O||null==k.return||k.return()}finally{if(E)throw N}}var A=!0,B=!1,z=void 0;try{for(var D,R=Object.values(a)[Symbol.iterator]();!(A=(D=R.next()).done);A=!0){var G=D.value;G.expanded&&(G.bounds=padBounds(G.bounds,{x:15,top:r.groupPaddingTop,bottom:r.groupPaddingBottom}))}}catch(t){B=!0,z=t}finally{try{A||null==R.return||R.return()}finally{if(B)throw z}}}var T=[];return n.edges().forEach(function(t){var r=n.node(t.v),o=n.node(t.w);if(r&&o){var i=g[t.v]?16:24,a=g[t.w]?16:24;T.push("horizontal"===e.direction?{from:{x:r.x+r.width/2,y:r.y},fromId:t.v,to:{x:o.x-o.width/2-5,y:o.y},toId:t.w}:{from:{x:r.x-r.width/2+i,y:r.y-30+r.height/2},fromId:t.v,to:{x:o.x-o.width/2+a,y:o.y+20-o.height/2},toId:t.w})}}),{nodes:w,edges:T,width:b+100,height:_+100,groups:y?a:{}}},getAssetLinkDimensions=function(t,e){return"horizontal"===e.direction?{width:32+7.1*Math.min(30,t.length),height:50}:{width:106,height:50}},padBounds=function(t,e){return{x:t.x-e.x,y:t.y-e.top,width:t.width+2*e.x,height:t.height+e.top+e.bottom}},extendBounds=function(t,e){var n=Math.min(t.x,e.x),r=Math.min(t.y,e.y);return{x:n,y:r,width:Math.max(t.x+t.width,e.x+e.width)-n,height:Math.max(t.y+t.height,e.y+e.height)-r}},x=320,getAssetNodeDimensions=function(t){var e,n=100;return t.isSource&&t.isObservable?n+=30:(n+=26,t.isPartitioned&&(n+=40)),(null===(e=t.changedReasons)||void 0===e?void 0:e.length)&&(n+=30),{width:x,height:n+=30}},titleOfIO=function(t){return"result"!==t.solid.name?"".concat(t.solid.name,":").concat(t.definition.name):t.solid.name};function flattenIO(t){var e={};return t.forEach(function(t){return t.forEach(function(t){return e[titleOfIO(t)]=t})}),Object.values(e)}function layoutExternalConnections(t,e,n){var r=n-166,o=Math.max(200,r/t.length),i=83+Math.min(0,(r-t.length*o)/2),a=o<300?20:0,u={};return t.forEach(function(t,n){u[titleOfIO(t)]={x:i+n*o,y:e+a*(1-n%2*2)}}),u}function layoutOp(t,e){var n=e.y,appendMiniIODots=function(t,r,o){var i,a=_to_consumable_array_to_consumable_array(t).sort(function(t,e){return r(t).localeCompare(r(e))}),u=0,d=null,s={},c=Math.min(35,370/(a.length+1));a.forEach(function(t,r){var a=o(t);a!==d?(d=a,i={port:{x:e.x+u+13,y:n+13},collapsed:[],label:!1,layout:{x:e.x+u,y:n,width:35,height:26}},s[t.definition.name]=i,u+=c):(0===i.collapsed.length&&(u+=15),i.collapsed.push(t.definition.name))});var h=(370-(u-13+35))/2;return Object.values(s).forEach(function(t){t.layout.x+=h,t.port.x+=h}),n+=26,s},appendStackedIOBoxes=function(t){var r={};return t.forEach(function(t){r[t.definition.name]={port:{x:e.x+13,y:n+13},label:!0,collapsed:[],layout:{x:e.x,y:n,width:0,height:26}},n+=26}),r},r=t.inputs.length>4?appendMiniIODots(t.inputs,function(t){return t.definition.name},function(t){var e;return(null===(e=t.dependsOn[0])||void 0===e?void 0:e.solid.name)||""}):appendStackedIOBoxes(t.inputs),o={x:e.x,y:Math.max(e.y,n-0),width:370,height:52};n+=52,t.definition.assetNodes.length&&t.definition.description&&(o.height+=22,n+=22);var i=t.outputs.length>4?appendMiniIODots(t.outputs,function(t){var e;return(null===(e=t.dependedBy[0])||void 0===e?void 0:e.definition.name)||""},function(t){var e;return(null===(e=t.dependedBy[0])||void 0===e?void 0:e.solid.name)||""}):appendStackedIOBoxes(t.outputs);return{bounds:{x:e.x-5,y:e.y-5,width:380,height:n-e.y+10},op:o,inputs:r,outputs:i}}self.addEventListener("message",function(t){var e=t.data;switch(e.type){case"layoutOpGraph":var n,r,o,i,a,u,s,c,h,l,f,p,y,g,m,v=e.ops,x=e.opts;self.postMessage((a=new d.graphlib.Graph,u=0,s=100,c=100,x.parentOp&&(s=(c=140)+(u=26*Math.max(x.parentOp.inputs.length,x.parentOp.outputs.length))),a.setGraph({rankdir:"TB",marginx:c,marginy:s,ranker:"tight-tree"}),a.setDefaultEdgeLabel(function(){return{}}),h=[],l={},v.forEach(function(t){l[t.name]=!0}),v.forEach(function(t){var e=layoutOp(t,{x:0,y:0});a.setNode(t.name,{width:e.bounds.width,height:e.bounds.height}),t.inputs.forEach(function(e){e.dependsOn.forEach(function(n){l[n.solid.name]&&l[t.name]&&(a.setEdge({v:n.solid.name,w:t.name},{weight:1}),h.push({from:{point:{x:0,y:0},opName:n.solid.name,edgeName:n.definition.name},to:{point:{x:0,y:0},opName:t.name,edgeName:e.definition.name}}))})})}),d.layout(a),f={},p={},a.nodes().forEach(function(t){var e=a.node(t);e&&(p[t]=e)}),y=0,g=0,Object.entries(p).forEach(function(t){var e=_sliced_to_array_sliced_to_array(t,2),n=e[0],r=e[1],o=v.find(function(t){return t.name===n});if(o){var i=r.x-r.width/2,a=r.y-r.height/2;f[n]=layoutOp(o,{x:i,y:a}),y=Math.max(y,i+r.width),g=Math.max(g,a+r.height)}}),a.edges().forEach(function(t){var e=h.find(function(e){return e.from.opName===t.v&&e.to.opName===t.w}),n=a.edge(t).points;e&&n.length>0&&(e.from.point=n[0],e.to.point=n[n.length-1])}),m={edges:h,nodes:f,width:y+c,height:g+s,parent:null},x.parentOp&&(m.parent=(n=x.parentOp,r=u,i=(o={invocationBoundingBox:{x:1,y:1,width:m.width-1,height:m.height-1},bounds:{x:70,y:70+r,width:m.width-140,height:m.height-(70+r)*2},mappingLeftEdge:50,mappingLeftSpacing:10,inputs:{},outputs:{},dependsOn:layoutExternalConnections(flattenIO(n.inputs.map(function(t){return t.dependsOn})),-50,m.width),dependedBy:layoutExternalConnections(flattenIO(n.outputs.map(function(t){return t.dependedBy})),m.height+50,m.width)}).bounds.y+o.bounds.height,n.inputs.forEach(function(t,e){o.inputs[t.definition.name]={layout:{x:o.bounds.x,y:o.bounds.y-26*e-26,width:0,height:26},collapsed:[],label:!0,port:{x:o.bounds.x+13,y:o.bounds.y-26*e-13}}}),n.outputs.forEach(function(t,e){o.outputs[t.definition.name]={layout:{x:o.bounds.x,y:i+26*e,width:0,height:26},collapsed:[],label:!0,port:{x:o.bounds.x+13,y:i+26*e+13}}}),o)),m));break;case"layoutAssetGraph":var b=e.graphData,_=e.opts;self.postMessage(layoutAssetGraph(b,_))}})}}]);
//# sourceMappingURL=342.cd0c1c0f82dc53b8.js.map